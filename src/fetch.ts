const API_URL = "https://sbsconnect.nyc.gov/certified-businesses/";

function sanitizeJsonString(jsonString) {
  const controlChars = /[\u0000-\u001F\u007F-\u009F]/g;
  return jsonString.replace(controlChars, "");
}

export async function getVendorsByCode(nigpCodes: string[]) {
  const encodedNigpCodes = encodeURIComponent(nigpCodes.join());
  //   const url = `${API_URL}?keyword=&vendor_starts_with=&codecategory=both&nigp=${encodedNigpCodes}&min_contract_value=&max_contract_value=&min_contract_value_text=&max_contract_value_text=&min_bonding_value=&min_bonding_value_text=&zip=&page_size=20&page=1`;
  //   const textResponse = await fetch(url).then((a) => a.text());

  //   console.log(textResponse);
  const textResponse = `{ "version": 15, "total_record_count": 14, "results": [ { "accountid": "00aa9830-afdb-e811-814c-005056b6686e", "business_name": "Albion HVAC Supplies Inc.", "largest_contract_value": "2100000.0000000000", "description": "HVAC mechanical equipment such as fire dampers, heat exchangers, thermostats, boilers, pumps, access doors, filters & belts.", "phone": "718-668-9191", "email": "sales@hvacind.com", "certifications": [ "M/WBE Women-Owned Business Enterprise (WBE)" ] }, { "accountid": "eb9e9830-afdb-e811-814c-005056b6686e", "business_name": "Card Heating & Cooling, Inc.", "largest_contract_value": "42753.0000000000", "description": "HVAC Installation, sales & service of HVAC systems both residential & commercial.", "phone": "718-720-2496", "email": "acard60282@aol.com", "certifications": [ "M/WBE Minority-Owned Business Enterprise (MBE)" ] }, { "accountid": "6d6dc730-afdb-e811-814c-005056b6686e", "business_name": "Doctor Power Cooling & Heating Inc.", "largest_contract_value": "684000.0000000000", "description": "Doctor Power Cooling & Heating, Inc is a Bronx based HVAC company that performs New installations, repairs, duct fabrication, duct installation , duct cleaning and maintenance for every HVAC system. We also perform prime work expanding to concrete , sidewalk , fencing ,ETC.", "phone": "917-577-8626", "email": "Info@drpowerhvac.com", "certifications": [ "M/WBE Minority-Owned Business Enterprise (MBE)" , "LBE " ] }, { "accountid": "e8a89830-afdb-e811-814c-005056b6686e", "business_name": "Haas Incorporated", "largest_contract_value": "2900000.0000000000", "description": "Haas, a woman owned business, is NY's Premier HVAC/R and Energy Management company specializing in HVAC/R design, construction, equipment replacement, energy efficiency strategies and solutions,", "phone": "516-921-2016", "email": "sue@slhaas.com", "certifications": [ "M/WBE Women-Owned Business Enterprise (WBE)" ] }, { "accountid": "df71c730-afdb-e811-814c-005056b6686e", "business_name": "ieComfort, LLC", "largest_contract_value": "806000.0000000000", "description": "ieComfort, LLC is a technology company that provides HVAC and energy management, equipment, and equipment maintenance audits. In addition we offer services in VRF HVAC, Plasma ION Air Cleaner, BAS Controls, Wi-Fi Thermostats, Wireless Leak Detection with IOS/Android notification and Wi-Fi video cameras.", "phone": "860-201-6847", "email": "Bill.Harris@ieComfort.com", "certifications": [ "M/WBE Minority-Owned Business Enterprise (MBE)" ] }, { "accountid": "20c9d61a-d0e2-e811-812c-1458d04e2f20", "business_name": "JBSC CORP", "largest_contract_value": "22949119.0000000000", "description": "Fabricator and distributor of fluid sealing items such as gaskets, seals, washers, packing, matting, rubber stripping and other rubber products.", "phone": "631-254-4381", "email": "kromano@jbscco.com", "certifications": [ "M/WBE Women-Owned Business Enterprise (WBE)" ] }, { "accountid": "a550a822-baa4-4e46-b85c-08e0e9184eb1", "business_name": "MFB Mechanical Corp", "largest_contract_value": "42000.0000000000", "description": "With over 25 years of experience, MFB Mechanical Corp is a customer focused heating, air-conditioning, and commercial refrigeration company, proudly servicing customers in Westchester County and the New York Tri-State area. MFB Mechanical Corp specializes in designing, engineering, and installing complete comfort systems. From the professionalism of our sales staff to the dedication of our field personnel, we are dedicated to delivering you the best service possible. • Rooftop Units • Split Systems • Boilers • Ductwork (Installation and repair) • Chillers • VAV Systems • Temp Control Systems • Exhaust and supply fans • Make-up Air Units Additional Installations: • Air Filtration Products • Humidifiers • Fresh Air Ventilators • Ultra Violet Lights • Zoning and Programmable Thermostats", "phone": "914-779-3464", "email": "mfbmechanical@aol.com", "certifications": [ "M/WBE Minority-Owned Business Enterprise (MBE)" ] }, { "accountid": "86c3382a-9763-ed11-9562-001dd8072481", "business_name": "Mu Joy, Inc", "largest_contract_value": "34000.0000000000", "description": "Black, Women Owned Construction company", "phone": "516-885-0583", "email": "mu.joy@yahoo.com", "certifications": [ "M/WBE Minority Women-Owned Business Enterprise (M/WBE)" ] }, { "accountid": "88a89830-afdb-e811-814c-005056b6686e", "business_name": "P.I. Mechanical Corp.", "largest_contract_value": "3007471.0000000000", "description": "P.I. Mechanical is an HVAC mechanical company.", "phone": "212-229-1775", "email": "info@pimechanical.com", "certifications": [ "M/WBE Minority-Owned Business Enterprise (MBE)" ] }, { "accountid": "9ead9830-afdb-e811-814c-005056b6686e", "business_name": "Platinum Pump Corp.", "largest_contract_value": "", "description": "Platinum Pump Corp. repairs and installs new motors, pumps, fans, booster systems. We service commercial, industrial, and residential customers. We service tri-state area, NY, NJ, and CT.", "phone": "631-396-0708", "email": "gale@platinumpumpnyc.com", "certifications": [ "M/WBE Women-Owned Business Enterprise (WBE)" ] } ], "more_results": "true" , "next_page_number": "2" }`;

  try {
    const parsedData = JSON.parse(sanitizeJsonString(textResponse));
    console.log(parsedData);

    return parsedData;
  } catch (e) {
    console.error(e);
    return null;
  }
}
